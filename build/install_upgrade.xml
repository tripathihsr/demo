<project name="install_upgrade">
  
  <condition property="hybrisZipFileIsKnown">
     <isset property="hybris.zip.package.src" />
  </condition>


  <target name="install" description="Unpacks a specific commerce suite version in the workspace from a specified location">
      <echo>Unzipping Hybris platform from ${hybris.zip.package.src}</echo>
         <available file="${hybris.zip.package.src}" property="hybrisZipPresent" />
         <antcall target="failIfHybrisZipNotPresent" />
            <unzip src="${hybris.zip.package.src}" dest=".">
                  <patternset>
                        <include name="hybris/**/*"/>
                  </patternset>
            </unzip>
         <echo>Unzipping done!</echo>
         <antcall target="prepareconfig" />
  </target>      
    

  <target name="upgrade" description="Gets rid of hybris/bin/platform and hybris/bin/ext-* folders and unpaacks a specific commerce suite version in the workspace from a specified location">
         <available file="${hybris.zip.package.src}" property="hybrisZipPresent" />        
         <antcall target="failIfHybrisZipNotPresent" />
         <echo>Deleting platform binaries</echo> 
         <delete dir="${platformhome}" />
         
         <delete>
            <dirset dir="${HYBRIS_BIN_DIR}" includes="ext*/**" />
         </delete>
         <antcall target="install" />
  </target>

  <target name="failIfHybrisZipNotPresent" unless="hybrisZipPresent">
                        <fail>

********** CANNOT INSTALL ********************
Missing Hybris zip file ${hybris.zip.package.src}. Download it locally first.
**********************************************
                        </fail>
  </target>

</project>
